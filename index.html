<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>GTA5RP ‚Äî –æ—Ç—á—ë—Ç—ã –Ω–∞ –ø–æ–≤—ã—à–µ–Ω–∏–µ</title>
  <style>
    body { font-family: Arial; margin: 20px; }
    .block { padding: 12px; border: 1px solid #ccc; border-radius: 12px; margin-bottom: 12px; }
    .row { padding: 8px; border: 1px dashed #aaa; border-radius: 10px; margin-bottom: 10px; }
    .label { font-size: 12px; opacity: .7; }
    .error { color: #c0392b; margin-top: 8px; }
    textarea { width: 100%; }
  </style>
</head>

<body>

<h2>GTA5RP ‚Äî –æ—Ç—á—ë—Ç—ã –Ω–∞ –ø–æ–≤—ã—à–µ–Ω–∏–µ</h2>

<div class="block">
  ‚ö†Ô∏è –°–µ–π—á–∞—Å –æ—Ç—á—ë—Ç—ã –ù–ï —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è ‚Äî —ç—Ç–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.<br>
  –ù–∞ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ –ø–æ–¥–∫–ª—é—á–∏–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ GitHub –∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ—Ç—á—ë—Ç—ã.
</div>

<button id="createReportBtn">–°–æ–∑–¥–∞—Ç—å –æ—Ç—á—ë—Ç</button>

<div id="editor" style="display:none" class="block">
  <h3>–ù–æ–≤—ã–π –æ—Ç—á—ë—Ç</h3>

  <div id="fields"></div>

  <button id="addTextField">‚ûï –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ</button>
  <button id="addImageField">üñº –§–æ—Ç–æ</button>

  <div id="errorBox" class="error"></div>

  <br>
  <button id="saveReport">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç—á—ë—Ç</button>
</div>

<script>
const state = {
  draft: []
};

const fieldsBox = document.getElementById("fields");
const errorBox = document.getElementById("errorBox");

function addTextField() {
  const id = crypto.randomUUID();
  state.draft.push({ id, type: "text", name: "", value: "" });

  const div = document.createElement("div");
  div.className = "row";
  div.innerHTML = `
    <div class="label">–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è *</div>
    <input type="text" data-id="${id}" data-role="name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û—Ç—á—ë—Ç –∑–∞ –Ω–µ–¥–µ–ª—é" style="width:100%">

    <br><br>
    <div class="label">–¢–µ–∫—Å—Ç</div>
    <textarea rows="3" data-id="${id}" data-role="value" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç..."></textarea>
  `;

  fieldsBox.appendChild(div);

  div.querySelector('[data-role="name"]').oninput = e => {
    const f = state.draft.find(x => x.id === id);
    f.name = e.target.value.trim();
  };

  div.querySelector('[data-role="value"]').oninput = e => {
    const f = state.draft.find(x => x.id === id);
    f.value = e.target.value;
  };
}

function addImageField() {
  const id = crypto.randomUUID();
  state.draft.push({ id, type: "image", name: "", file: null, preview: "" });

  const div = document.createElement("div");
  div.className = "row";
  div.innerHTML = `
    <div class="label">–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è *</div>
    <input type="text" data-id="${id}" data-role="name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –°–∫—Ä–∏–Ω—à–æ—Ç—ã –¥–µ–∂—É—Ä—Å—Ç–≤–∞" style="width:100%">

    <br><br>
    <input type="file" accept="image/*" data-id="${id}" data-role="file">
    <br>
    <img data-id="${id}" data-role="preview" style="max-width:220px;display:none;margin-top:8px">
  `;

  fieldsBox.appendChild(div);

  const nameInput = div.querySelector('[data-role="name"]');
  const fileInput = div.querySelector('[data-role="file"]');
  const img = div.querySelector('[data-role="preview"]');

  nameInput.oninput = e => {
    const f = state.draft.find(x => x.id === id);
    f.name = e.target.value.trim();
  };

  fileInput.onchange = e => {
    const file = e.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = ev => {
      img.src = ev.target.result;
      img.style.display = "block";

      const f = state.draft.find(x => x.id === id);
      f.preview = ev.target.result;
      f.file = file;
    };
    reader.readAsDataURL(file);
  };
}

document.getElementById("addTextField").onclick = addTextField;
document.getElementById("addImageField").onclick = addImageField;

document.getElementById("createReportBtn").onclick = () => {
  state.draft = [];
  fieldsBox.innerHTML = "";
  errorBox.innerHTML = "";
  document.getElementById("editor").style.display = "block";
};

document.getElementById("saveReport").onclick = () => {
  errorBox.innerHTML = "";

  for (const f of state.draft) {
    if (!f.name) {
      errorBox.innerHTML = "‚ùó –£ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∏–º—è.";
      return;
    }
  }

  alert("‚úî –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞ ‚Äî –¥–∞–ª—å—à–µ –ø–æ–¥–∫–ª—é—á–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–∞ –≤ GitHub –∏ –ø—É–±–ª–∏—á–Ω—É—é —Å—Å—ã–ª–∫—É");
};
</script>

</body>
</html>
